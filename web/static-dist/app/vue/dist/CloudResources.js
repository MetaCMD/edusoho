(window.webpackJsonp=window.webpackJsonp||[]).push([[397],{127:function(e,t,a){e.exports=a(515)},1297:function(e,t,a){"use strict";a.r(t);var n=a(338),r=a.n(n),o=a(441),i=a.n(o),s=a(382),l=a.n(s),c=a(1326),d={name:"EditModal",props:{tags:{type:Array,required:!0}},data:function(){return{visible:!1,confirmLoading:!1,form:{id:void 0,tagIds:void 0,replayPublic:"0"}}},methods:{showModal:function(e){var t=e.id,a=e.replayPublic;this.form.id=t,this.form.replayPublic=a,this.visible=!0},handleCancel:function(){this.visible=!1},handleOk:function(){var e=this;return i()(r.a.mark((function t(){var a,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.confirmLoading=!0,a={query:{id:e.form.id},params:e.form},t.next=4,c.j.update(a);case 4:n=t.sent,n.success&&(e.$message.success(Translator.trans("message.edit_succeeded")),e.confirmLoading=!1,e.visible=!1,e.$emit("success",e.form));case 7:case"end":return t.stop()}}),t)})))()}}},u=a(30),m=Object(u.a)(d,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e._f("trans")("modal.title.edit"),visible:e.visible,"confirm-loading":e.confirmLoading},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-form-model",{attrs:{model:e.form,labelCol:{span:4},wrapperCol:{span:20}}},[a("a-form-model-item",{attrs:{label:e._f("trans")("form.label.tag")}},[a("a-select",{attrs:{mode:"multiple",placeholder:e._f("trans")("placeholder.playback_label")},model:{value:e.form.tagIds,callback:function(t){e.$set(e.form,"tagIds",t)},expression:"form.tagIds"}},e._l(e.tags,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v("\n          "+e._s(t.name)+"\n        ")])})),1)],1),e._v(" "),a("a-form-model-item",{attrs:{label:e._f("trans")("form.label.share")}},[a("a-radio-group",{model:{value:e.form.replayPublic,callback:function(t){e.$set(e.form,"replayPublic",t)},expression:"form.replayPublic"}},[a("a-radio",{staticClass:"mt8",attrs:{value:"1"}},[e._v("\n          "+e._s(e._f("trans")("radio.share_to_live_playback"))+"\n        ")]),e._v(" "),a("a-radio",{staticClass:"mt8",attrs:{value:"0"}},[e._v("\n          "+e._s(e._f("trans")("radio.visible_only_to_yourself"))+"\n        ")])],1)],1)],1)],1)}),[],!1,null,null,null).exports,f={name:"RemoveModal",data:function(){return{visible:!1,confirmLoading:!1,currentId:void 0}},methods:{showModal:function(e){this.currentId=e,this.visible=!0},handleCancel:function(){this.visible=!1},handleOk:function(){var e=this;return i()(r.a.mark((function t(){var a,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.confirmLoading=!0,a={data:{ids:[e.currentId],realDelete:!1}},t.next=4,c.j.delete(a);case 4:n=t.sent,n.success&&(e.$message.success(Translator.trans("message.removal_succeeded")),e.confirmLoading=!1,e.visible=!1,e.$emit("success",e.currentId));case 7:case"end":return t.stop()}}),t)})))()}}},p=Object(u.a)(f,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e._f("trans")("site.btn.remove_playback"),visible:e.visible},on:{cancel:e.handleCancel}},[e._v("\n  "+e._s(e._f("trans")("modal.content.remove_playback_resources"))+"\n  "),a("template",{slot:"footer"},[a("div",{staticClass:"clearfix"},[a("span",{staticClass:"pull-left",staticStyle:{color:"#fe4040","margin-top":"7px"}},[e._v("\n        "+e._s(e._f("trans")("live.playback.tip.cannot_be_used_normally"))+"\n      ")]),e._v(" "),a("a-button",{attrs:{type:"danger",loading:e.confirmLoading},on:{click:e.handleOk}},[e._v("\n        "+e._s(e._f("trans")("site.btn.confirm"))+"\n      ")])],1)])],2)}),[],!1,null,null,null).exports,v=[{title:Translator.trans("live_name"),dataIndex:"title"},{title:Translator.trans("live_statistics.presenter"),dataIndex:"anchor"},{title:Translator.trans("live_playback_duration"),dataIndex:"liveTime"},{title:Translator.trans("live_statistics.live_time"),dataIndex:"liveStartTime"},{title:Translator.trans("live_statistics.operation"),scopedSlots:{customRender:"actions"}}],h={name:"LivePlayback",components:{EditModal:m,RemoveModal:p},data:function(){return{searchForm:{time:void 0,replayTagId:void 0,courseCategoryId:void 0,keyword:""},data:[],columns:v,pagination:{hideOnSinglePage:!0,current:1,pageSize:10,total:0},loading:!1,categoryData:[],tagData:[]}},mounted:function(){this.fetchLiveReplay(),this.fetchCourseCategory(),this.fetchCourseTag()},methods:{fetchCourseCategory:function(){var e=this;return i()(r.a.mark((function t(){var a,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.d.get();case 2:a=t.sent,n=a.data,e.categoryData=n;case 5:case"end":return t.stop()}}),t)})))()},fetchCourseTag:function(){var e=this;return i()(r.a.mark((function t(){var a,n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.g.get();case 2:a=t.sent,n=a.data,e.tagData=n;case 5:case"end":return t.stop()}}),t)})))()},handleClickSearch:function(){var e=l.a.pickBy(this.searchForm,l.a.identity);if(l.a.size(e)){var t=e.time;t&&(e.startTime=moment(t[0]).unix(),e.endTime=moment(t[1]).unix(),delete e.time),this.pagination.current=1,this.fetchLiveReplay(e)}},handleTableChange:function(e){this.pagination.current=e.current,this.fetchLiveReplay()},fetchLiveReplay:function(){var e=arguments,t=this;return i()(r.a.mark((function a(){var n,o,i,s,l,d,u,m;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},t.loading=!0,o=t.pagination,i=o.current,s=o.pageSize,l={query:n,params:{offset:(i-1)*s,limit:s}},a.next=6,c.j.get(l);case 6:d=a.sent,u=d.data,m=d.paging,t.loading=!1,t.pagination.total=m.total,t.data=u;case 12:case"end":return a.stop()}}),a)})))()},handleClickView:function(e){window.open(e)},handleClickEdit:function(e){this.$refs.editModal.showModal(e)},handleClickRemove:function(e){this.$refs.removeModal.showModal(e)},removeSuccess:function(e){var t=this;l.a.forEach(this.data,(function(a,n){if(a.id===e)return t.data.splice(n,1),!1}))},editSuccess:function(e){var t=e.id,a=e.replayPublic;l.a.forEach(this.data,(function(e,n){if(e.id===t)return e.replayPublic=a,!1}))}}},_=Object(u.a)(h,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-form-model",{staticClass:"mt16",attrs:{layout:"inline",model:e.searchForm}},[a("a-form-model-item",{attrs:{label:e._f("trans")("site.time")}},[a("a-range-picker",{model:{value:e.searchForm.time,callback:function(t){e.$set(e.searchForm,"time",t)},expression:"searchForm.time"}})],1),e._v(" "),a("a-form-model-item",[a("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:e._f("trans")("placeholder.course_category")},model:{value:e.searchForm.courseCategoryId,callback:function(t){e.$set(e.searchForm,"courseCategoryId",t)},expression:"searchForm.courseCategoryId"}},e._l(e.categoryData,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v("\n          "+e._s(t.name)+"\n        ")])})),1)],1),e._v(" "),a("a-form-model-item",[a("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:e._f("trans")("placeholder.playback_label")},model:{value:e.searchForm.replayTagId,callback:function(t){e.$set(e.searchForm,"replayTagId",t)},expression:"searchForm.replayTagId"}},e._l(e.tagData,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v("\n          "+e._s(t.name)+"\n        ")])})),1)],1),e._v(" "),a("a-form-model-item",[a("a-input",{staticStyle:{width:"200px"},attrs:{placeholder:e._f("trans")("placeholder.enter_keyword")},model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}})],1),e._v(" "),a("a-form-model-item",[a("a-button",{attrs:{type:"primary"},on:{click:e.handleClickSearch}},[e._v("\n        "+e._s(e._f("trans")("site.search_hint"))+"\n      ")])],1)],1),e._v(" "),a("a-table",{staticClass:"mt16",attrs:{columns:e.columns,"row-key":function(e){return e.id},"data-source":e.data,pagination:e.pagination,loading:e.loading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"actions",fn:function(t){return[a("a-button-group",[a("a-button",{staticStyle:{padding:"0 8px"},attrs:{type:"primary"},on:{click:function(a){return e.handleClickEdit(t)}}},[e._v("\n          "+e._s(e._f("trans")("modal.title.edit"))+"\n        ")]),e._v(" "),a("a-dropdown",{attrs:{placement:"bottomRight"}},[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{on:{click:function(a){return e.handleClickView(t.url)}}},[e._v("\n              "+e._s(e._f("trans")("site.btn.view_playback"))+"\n            ")]),e._v(" "),a("a-menu-item",{on:{click:function(a){return e.handleClickRemove(t.id)}}},[e._v("\n              "+e._s(e._f("trans")("site.btn.remove_playback"))+"\n            ")])],1),e._v(" "),a("a-button",{staticStyle:{padding:"0 8px"},attrs:{type:"primary"}},[a("a-icon",{attrs:{type:"down"}})],1)],1)],1)]}}])}),e._v(" "),a("remove-modal",{ref:"removeModal",on:{success:e.removeSuccess}}),e._v(" "),a("edit-modal",{ref:"editModal",attrs:{tags:e.tagData},on:{success:e.editSuccess}})],1)}),[],!1,null,null,null);t.default=_.exports},1329:function(e,t,a){a(1330),e.exports=a(48).Reflect.deleteProperty},1330:function(e,t,a){var n=a(78),r=a(181).f,o=a(132);n(n.S,"Reflect",{deleteProperty:function(e,t){var a=r(o(e),t);return!(a&&!a.configurable)&&delete e[t]}})},1335:function(e,t,a){e.exports=a(1329)},2:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},3:function(e,t,a){var n=a(127);function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),n(e,r.key,r)}}e.exports=function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}}]);